import{r as Rt,d as Wn,c as J,p as Zn,a as G,b as Le,e as Yn,l as Xn,i as $,N as Qn,S as xe,f as ve,F as Ke,g as lt,t as B,o as er,V as tr,h as nr,u as Ot,s as rr}from"./utils-cxvEfPFo.js";import{l as It,x as Nt,V as sr,n as ir,m as ne,a as or,S as ar}from"./index-BxVa1GLd.js";function At(n,i,a,o){function u(g){return g instanceof a?g:new a(function(v){v(g)})}return new(a||(a=Promise))(function(g,v){function _(L){try{V(o.next(L))}catch(F){v(F)}}function T(L){try{V(o.throw(L))}catch(F){v(F)}}function V(L){L.done?g(L.value):u(L.value).then(_,T)}V((o=o.apply(n,[])).next())})}var Je=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ht(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Ae={exports:{}};Ae.exports;var Pt;function lr(){return Pt||(Pt=1,function(n,i){var a=200,o="__lodash_hash_undefined__",u=1,g=2,v=9007199254740991,_="[object Arguments]",T="[object Array]",V="[object AsyncFunction]",L="[object Boolean]",F="[object Date]",Q="[object Error]",j="[object Function]",q="[object GeneratorFunction]",U="[object Map]",R="[object Number]",re="[object Null]",m="[object Object]",f="[object Promise]",M="[object Proxy]",N="[object RegExp]",E="[object Set]",r="[object String]",l="[object Symbol]",c="[object Undefined]",d="[object WeakMap]",h="[object ArrayBuffer]",w="[object DataView]",x="[object Float32Array]",ee="[object Float64Array]",se="[object Int8Array]",b="[object Int16Array]",I="[object Int32Array]",k="[object Uint8Array]",de="[object Uint8ClampedArray]",Ee="[object Uint16Array]",ke="[object Uint32Array]",We=/[\\^$.*+?()[\]{}|]/g,Be=/^\[object .+?Constructor\]$/,je=/^(?:0|[1-9]\d*)$/,C={};C[x]=C[ee]=C[se]=C[b]=C[I]=C[k]=C[de]=C[Ee]=C[ke]=!0,C[_]=C[T]=C[h]=C[L]=C[w]=C[F]=C[Q]=C[j]=C[U]=C[R]=C[m]=C[N]=C[E]=C[r]=C[d]=!1;var be=typeof Je=="object"&&Je&&Je.Object===Object&&Je,Re=typeof self=="object"&&self&&self.Object===Object&&self,Z=be||Re||Function("return this")(),$e=i&&!i.nodeType&&i,Ce=$e&&!0&&n&&!n.nodeType&&n,we=Ce&&Ce.exports===$e,oe=we&&be.process,S=function(){try{return oe&&oe.binding&&oe.binding("util")}catch{}}(),K=S&&S.isTypedArray;function ce(e,t){for(var s=-1,p=e==null?0:e.length,O=0,y=[];++s<p;){var P=e[s];t(P,s,e)&&(y[O++]=P)}return y}function Ne(e,t){for(var s=-1,p=t.length,O=e.length;++s<p;)e[O+s]=t[s];return e}function Dt(e,t){for(var s=-1,p=e==null?0:e.length;++s<p;)if(t(e[s],s,e))return!0;return!1}function Ft(e,t){for(var s=-1,p=Array(e);++s<e;)p[s]=t(s);return p}function zt(e){return function(t){return e(t)}}function Gt(e,t){return e.has(t)}function Vt(e,t){return e?.[t]}function qt(e){var t=-1,s=Array(e.size);return e.forEach(function(p,O){s[++t]=[O,p]}),s}function Ut(e,t){return function(s){return e(t(s))}}function Jt(e){var t=-1,s=Array(e.size);return e.forEach(function(p){s[++t]=p}),s}var Kt=Array.prototype,Wt=Function.prototype,He=Object.prototype,Ze=Z["__core-js_shared__"],ut=Wt.toString,ie=He.hasOwnProperty,pt=function(){var e=/[^.]+$/.exec(Ze&&Ze.keys&&Ze.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ft=He.toString,Zt=RegExp("^"+ut.call(ie).replace(We,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),dt=we?Z.Buffer:void 0,De=Z.Symbol,ht=Z.Uint8Array,gt=He.propertyIsEnumerable,Yt=Kt.splice,he=De?De.toStringTag:void 0,mt=Object.getOwnPropertySymbols,Xt=dt?dt.isBuffer:void 0,Qt=Ut(Object.keys,Object),Ye=Se(Z,"DataView"),Te=Se(Z,"Map"),Xe=Se(Z,"Promise"),Qe=Se(Z,"Set"),et=Se(Z,"WeakMap"),Me=Se(Object,"create"),en=_e(Ye),tn=_e(Te),nn=_e(Xe),rn=_e(Qe),sn=_e(et),_t=De?De.prototype:void 0,tt=_t?_t.valueOf:void 0;function ge(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var p=e[t];this.set(p[0],p[1])}}function on(){this.__data__=Me?Me(null):{},this.size=0}function an(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function ln(e){var t=this.__data__;if(Me){var s=t[e];return s===o?void 0:s}return ie.call(t,e)?t[e]:void 0}function cn(e){var t=this.__data__;return Me?t[e]!==void 0:ie.call(t,e)}function un(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=Me&&t===void 0?o:t,this}ge.prototype.clear=on,ge.prototype.delete=an,ge.prototype.get=ln,ge.prototype.has=cn,ge.prototype.set=un;function ae(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var p=e[t];this.set(p[0],p[1])}}function pn(){this.__data__=[],this.size=0}function fn(e){var t=this.__data__,s=ze(t,e);if(s<0)return!1;var p=t.length-1;return s==p?t.pop():Yt.call(t,s,1),--this.size,!0}function dn(e){var t=this.__data__,s=ze(t,e);return s<0?void 0:t[s][1]}function hn(e){return ze(this.__data__,e)>-1}function gn(e,t){var s=this.__data__,p=ze(s,e);return p<0?(++this.size,s.push([e,t])):s[p][1]=t,this}ae.prototype.clear=pn,ae.prototype.delete=fn,ae.prototype.get=dn,ae.prototype.has=hn,ae.prototype.set=gn;function me(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var p=e[t];this.set(p[0],p[1])}}function mn(){this.size=0,this.__data__={hash:new ge,map:new(Te||ae),string:new ge}}function _n(e){var t=Ge(this,e).delete(e);return this.size-=t?1:0,t}function yn(e){return Ge(this,e).get(e)}function vn(e){return Ge(this,e).has(e)}function bn(e,t){var s=Ge(this,e),p=s.size;return s.set(e,t),this.size+=s.size==p?0:1,this}me.prototype.clear=mn,me.prototype.delete=_n,me.prototype.get=yn,me.prototype.has=vn,me.prototype.set=bn;function Fe(e){var t=-1,s=e==null?0:e.length;for(this.__data__=new me;++t<s;)this.add(e[t])}function wn(e){return this.__data__.set(e,o),this}function Sn(e){return this.__data__.has(e)}Fe.prototype.add=Fe.prototype.push=wn,Fe.prototype.has=Sn;function ue(e){var t=this.__data__=new ae(e);this.size=t.size}function xn(){this.__data__=new ae,this.size=0}function $n(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s}function Cn(e){return this.__data__.get(e)}function Tn(e){return this.__data__.has(e)}function Mn(e,t){var s=this.__data__;if(s instanceof ae){var p=s.__data__;if(!Te||p.length<a-1)return p.push([e,t]),this.size=++s.size,this;s=this.__data__=new me(p)}return s.set(e,t),this.size=s.size,this}ue.prototype.clear=xn,ue.prototype.delete=$n,ue.prototype.get=Cn,ue.prototype.has=Tn,ue.prototype.set=Mn;function On(e,t){var s=Ve(e),p=!s&&Gn(e),O=!s&&!p&&nt(e),y=!s&&!p&&!O&&Tt(e),P=s||p||O||y,H=P?Ft(e.length,String):[],D=H.length;for(var A in e)ie.call(e,A)&&!(P&&(A=="length"||O&&(A=="offset"||A=="parent")||y&&(A=="buffer"||A=="byteLength"||A=="byteOffset")||Nn(A,D)))&&H.push(A);return H}function ze(e,t){for(var s=e.length;s--;)if(St(e[s][0],t))return s;return-1}function In(e,t,s){var p=t(e);return Ve(e)?p:Ne(p,s(e))}function Oe(e){return e==null?e===void 0?c:re:he&&he in Object(e)?jn(e):zn(e)}function yt(e){return Ie(e)&&Oe(e)==_}function vt(e,t,s,p,O){return e===t?!0:e==null||t==null||!Ie(e)&&!Ie(t)?e!==e&&t!==t:An(e,t,s,p,vt,O)}function An(e,t,s,p,O,y){var P=Ve(e),H=Ve(t),D=P?T:pe(e),A=H?T:pe(t);D=D==_?m:D,A=A==_?m:A;var W=D==m,te=A==m,z=D==A;if(z&&nt(e)){if(!nt(t))return!1;P=!0,W=!1}if(z&&!W)return y||(y=new ue),P||Tt(e)?bt(e,t,s,p,O,y):kn(e,t,D,s,p,O,y);if(!(s&u)){var Y=W&&ie.call(e,"__wrapped__"),X=te&&ie.call(t,"__wrapped__");if(Y||X){var fe=Y?e.value():e,le=X?t.value():t;return y||(y=new ue),O(fe,le,s,p,y)}}return z?(y||(y=new ue),Bn(e,t,s,p,O,y)):!1}function Pn(e){if(!Ct(e)||Dn(e))return!1;var t=xt(e)?Zt:Be;return t.test(_e(e))}function Ln(e){return Ie(e)&&$t(e.length)&&!!C[Oe(e)]}function En(e){if(!Fn(e))return Qt(e);var t=[];for(var s in Object(e))ie.call(e,s)&&s!="constructor"&&t.push(s);return t}function bt(e,t,s,p,O,y){var P=s&u,H=e.length,D=t.length;if(H!=D&&!(P&&D>H))return!1;var A=y.get(e);if(A&&y.get(t))return A==t;var W=-1,te=!0,z=s&g?new Fe:void 0;for(y.set(e,t),y.set(t,e);++W<H;){var Y=e[W],X=t[W];if(p)var fe=P?p(X,Y,W,t,e,y):p(Y,X,W,e,t,y);if(fe!==void 0){if(fe)continue;te=!1;break}if(z){if(!Dt(t,function(le,ye){if(!Gt(z,ye)&&(Y===le||O(Y,le,s,p,y)))return z.push(ye)})){te=!1;break}}else if(!(Y===X||O(Y,X,s,p,y))){te=!1;break}}return y.delete(e),y.delete(t),te}function kn(e,t,s,p,O,y,P){switch(s){case w:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case h:return!(e.byteLength!=t.byteLength||!y(new ht(e),new ht(t)));case L:case F:case R:return St(+e,+t);case Q:return e.name==t.name&&e.message==t.message;case N:case r:return e==t+"";case U:var H=qt;case E:var D=p&u;if(H||(H=Jt),e.size!=t.size&&!D)return!1;var A=P.get(e);if(A)return A==t;p|=g,P.set(e,t);var W=bt(H(e),H(t),p,O,y,P);return P.delete(e),W;case l:if(tt)return tt.call(e)==tt.call(t)}return!1}function Bn(e,t,s,p,O,y){var P=s&u,H=wt(e),D=H.length,A=wt(t),W=A.length;if(D!=W&&!P)return!1;for(var te=D;te--;){var z=H[te];if(!(P?z in t:ie.call(t,z)))return!1}var Y=y.get(e);if(Y&&y.get(t))return Y==t;var X=!0;y.set(e,t),y.set(t,e);for(var fe=P;++te<D;){z=H[te];var le=e[z],ye=t[z];if(p)var Mt=P?p(ye,le,z,t,e,y):p(le,ye,z,e,t,y);if(!(Mt===void 0?le===ye||O(le,ye,s,p,y):Mt)){X=!1;break}fe||(fe=z=="constructor")}if(X&&!fe){var qe=e.constructor,Ue=t.constructor;qe!=Ue&&"constructor"in e&&"constructor"in t&&!(typeof qe=="function"&&qe instanceof qe&&typeof Ue=="function"&&Ue instanceof Ue)&&(X=!1)}return y.delete(e),y.delete(t),X}function wt(e){return In(e,Un,Rn)}function Ge(e,t){var s=e.__data__;return Hn(t)?s[typeof t=="string"?"string":"hash"]:s.map}function Se(e,t){var s=Vt(e,t);return Pn(s)?s:void 0}function jn(e){var t=ie.call(e,he),s=e[he];try{e[he]=void 0;var p=!0}catch{}var O=ft.call(e);return p&&(t?e[he]=s:delete e[he]),O}var Rn=mt?function(e){return e==null?[]:(e=Object(e),ce(mt(e),function(t){return gt.call(e,t)}))}:Jn,pe=Oe;(Ye&&pe(new Ye(new ArrayBuffer(1)))!=w||Te&&pe(new Te)!=U||Xe&&pe(Xe.resolve())!=f||Qe&&pe(new Qe)!=E||et&&pe(new et)!=d)&&(pe=function(e){var t=Oe(e),s=t==m?e.constructor:void 0,p=s?_e(s):"";if(p)switch(p){case en:return w;case tn:return U;case nn:return f;case rn:return E;case sn:return d}return t});function Nn(e,t){return t=t??v,!!t&&(typeof e=="number"||je.test(e))&&e>-1&&e%1==0&&e<t}function Hn(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Dn(e){return!!pt&&pt in e}function Fn(e){var t=e&&e.constructor,s=typeof t=="function"&&t.prototype||He;return e===s}function zn(e){return ft.call(e)}function _e(e){if(e!=null){try{return ut.call(e)}catch{}try{return e+""}catch{}}return""}function St(e,t){return e===t||e!==e&&t!==t}var Gn=yt(function(){return arguments}())?yt:function(e){return Ie(e)&&ie.call(e,"callee")&&!gt.call(e,"callee")},Ve=Array.isArray;function Vn(e){return e!=null&&$t(e.length)&&!xt(e)}var nt=Xt||Kn;function qn(e,t){return vt(e,t)}function xt(e){if(!Ct(e))return!1;var t=Oe(e);return t==j||t==q||t==V||t==M}function $t(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=v}function Ct(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function Ie(e){return e!=null&&typeof e=="object"}var Tt=K?zt(K):Ln;function Un(e){return Vn(e)?On(e):En(e)}function Jn(){return[]}function Kn(){return!1}n.exports=qn}(Ae,Ae.exports)),Ae.exports}var cr=lr(),ur=Ht(cr);function st(n,i,a){const o={id:[i,a,"circle"].join("_"),source:i,type:"circle",paint:{"circle-color":n,"circle-radius":2},filter:["==","$type","Point"]};return a&&(o["source-layer"]=a),o}function it(n,i,a,o){const u={id:[a,o,"polygon"].join("_"),source:a,type:"fill",paint:{"fill-color":n,"fill-antialias":!0,"fill-outline-color":n},filter:["==","$type","Polygon"]};return o&&(u["source-layer"]=o),u}function ot(n,i,a){const o={id:[i,a,"line"].join("_"),source:i,layout:{"line-join":"round","line-cap":"round"},type:"line",paint:{"line-color":n},filter:["==","$type","LineString"]};return a&&(o["source-layer"]=a),o}function Lt(n,i){return{circle:i(n,.8),line:i(n,.6),polygon:i(n,.3),polygonOutline:i(n,.6),default:i(n,1)}}function pr(n,i){const a=[],o=[],u=[];for(const g of Object.keys(n)){const v=n[g];if(!v||v.length===0){const _=Lt(g,i);o.push(st(_.circle,g)),u.push(ot(_.line,g)),a.push(it(_.polygon,_.polygonOutline,g))}else for(const _ of v){const T=Lt(_,i);o.push(st(T.circle,g,_)),u.push(ot(T.line,g,_)),a.push(it(T.polygon,T.polygonOutline,g,_))}}return a.concat(u).concat(o)}function fr(n,i,a){a=Object.assign({backgroundColor:"#fff"},a);const o={id:"background",type:"background",paint:{"background-color":a.backgroundColor}},u={};for(const g of Object.keys(n.sources)){const v=n.sources[g];(v.type==="vector"||v.type==="geojson")&&(u[g]=v)}return Object.assign(n,{layers:[o].concat(i),sources:u})}var Et={polygonLayer:it,lineLayer:ot,circleLayer:st,generateInspectStyle:fr,generateColoredLayers:pr};class dr{constructor(i){i=Object.assign({show:!0,onToggle(){}},i),this._btn=this.createButton(),this._btn.onclick=i.onToggle,this.elem=this.createContainer(this._btn,i.show)}createButton(){const i=document.createElement("button");return i.className="maplibregl-ctrl-icon maplibregl-ctrl-inspect",i.type="button",i.title="Toggle Inspect",i.setAttribute("aria-label","Toggle Inspect"),i}createContainer(i,a){const o=document.createElement("div");return o.className="maplibregl-ctrl maplibregl-ctrl-group",o.appendChild(i),a||(o.style.display="none"),o}setInspectIcon(){this._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-inspect"}setMapIcon(){this._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-map"}}function hr(n){return typeof n>"u"||n===null?n:n instanceof Date?n.toLocaleString():typeof n=="object"||typeof n=="number"||typeof n=="string"?n.toString():n}function rt(n,i){return`<div class="maplibregl-inspect_property"><div class="maplibregl-inspect_property-name">${n}</div><div class="maplibregl-inspect_property-value">${hr(i)}</div></div>`}function gr(n){return`<div class="maplibregl-inspect_layer">${n}</div>`}function mr(n){const i=gr(n.layer["source-layer"]||n.layer.source),a=rt("$id",n.id),o=rt("$type",n.geometry.type),u=Object.keys(n.properties).map(g=>rt(g,n.properties[g]));return[i,a,o].concat(u).join("")}function _r(n){return n.map(i=>`<div class="maplibregl-inspect_feature">${mr(i)}</div>`).join("")}function yr(n){return`<div class="maplibregl-inspect_popup">${_r(n)}</div>`}var Pe={exports:{}},vr=Pe.exports,kt;function br(){return kt||(kt=1,function(n,i){(function(a,o){{var u=o();n&&n.exports&&(i=n.exports=u),i.randomColor=u}})(vr,function(){var a=null,o={};re();var u=[],g=function(r){if(r=r||{},r.seed!==void 0&&r.seed!==null&&r.seed===parseInt(r.seed,10))a=r.seed;else if(typeof r.seed=="string")a=N(r.seed);else{if(r.seed!==void 0&&r.seed!==null)throw new TypeError("The seed value must be an integer or string");a=null}var l,c,d;if(r.count!==null&&r.count!==void 0){for(var h=r.count,w=[],x=0;x<r.count;x++)u.push(!1);for(r.count=null;h>w.length;){var ee=g(r);a!==null&&(r.seed=a),w.push(ee)}return r.count=h,w}return l=v(r),c=_(l,r),d=T(l,c,r),V([l,c,d],r)};function v(r){if(u.length>0){var l=E(r.hue),c=q(l),d=(l[1]-l[0])/u.length,h=parseInt((c-l[0])/d);u[h]===!0?h=(h+2)%u.length:u[h]=!0;var w=(l[0]+h*d)%359,x=(l[0]+(h+1)*d)%359;return l=[w,x],c=q(l),c<0&&(c=360+c),c}else{var l=F(r.hue);return c=q(l),c<0&&(c=360+c),c}}function _(r,l){if(l.hue==="monochrome")return 0;if(l.luminosity==="random")return q([0,100]);var c=Q(r),d=c[0],h=c[1];switch(l.luminosity){case"bright":d=55;break;case"dark":d=h-10;break;case"light":h=55;break}return q([d,h])}function T(r,l,c){var d=L(r,l),h=100;switch(c.luminosity){case"dark":h=d+20;break;case"light":d=(h+d)/2;break;case"random":d=0,h=100;break}return q([d,h])}function V(r,l){switch(l.format){case"hsvArray":return r;case"hslArray":return M(r);case"hsl":var c=M(r);return"hsl("+c[0]+", "+c[1]+"%, "+c[2]+"%)";case"hsla":var d=M(r),x=l.alpha||Math.random();return"hsla("+d[0]+", "+d[1]+"%, "+d[2]+"%, "+x+")";case"rgbArray":return m(r);case"rgb":var h=m(r);return"rgb("+h.join(", ")+")";case"rgba":var w=m(r),x=l.alpha||Math.random();return"rgba("+w.join(", ")+", "+x+")";default:return U(r)}}function L(r,l){for(var c=j(r).lowerBounds,d=0;d<c.length-1;d++){var h=c[d][0],w=c[d][1],x=c[d+1][0],ee=c[d+1][1];if(l>=h&&l<=x){var se=(ee-w)/(x-h),b=w-se*h;return se*l+b}}return 0}function F(r){if(typeof parseInt(r)=="number"){var l=parseInt(r);if(l<360&&l>0)return[l,l]}if(typeof r=="string"){if(o[r]){var c=o[r];if(c.hueRange)return c.hueRange}else if(r.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){var d=f(r)[0];return[d,d]}}return[0,360]}function Q(r){return j(r).saturationRange}function j(r){r>=334&&r<=360&&(r-=360);for(var l in o){var c=o[l];if(c.hueRange&&r>=c.hueRange[0]&&r<=c.hueRange[1])return o[l]}return"Color not found"}function q(r){if(a===null){var l=.618033988749895,c=Math.random();return c+=l,c%=1,Math.floor(r[0]+c*(r[1]+1-r[0]))}else{var d=r[1]||1,h=r[0]||0;a=(a*9301+49297)%233280;var w=a/233280;return Math.floor(h+w*(d-h))}}function U(r){var l=m(r);function c(h){var w=h.toString(16);return w.length==1?"0"+w:w}var d="#"+c(l[0])+c(l[1])+c(l[2]);return d}function R(r,l,c){var d=c[0][0],h=c[c.length-1][0],w=c[c.length-1][1],x=c[0][1];o[r]={hueRange:l,lowerBounds:c,saturationRange:[d,h],brightnessRange:[w,x]}}function re(){R("monochrome",null,[[0,0],[100,0]]),R("red",[-26,18],[[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]),R("orange",[18,46],[[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]),R("yellow",[46,62],[[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]),R("green",[62,178],[[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]),R("blue",[178,257],[[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]),R("purple",[257,282],[[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]),R("pink",[282,334],[[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]])}function m(r){var l=r[0];l===0&&(l=1),l===360&&(l=359),l=l/360;var c=r[1]/100,d=r[2]/100,h=Math.floor(l*6),w=l*6-h,x=d*(1-c),ee=d*(1-w*c),se=d*(1-(1-w)*c),b=256,I=256,k=256;switch(h){case 0:b=d,I=se,k=x;break;case 1:b=ee,I=d,k=x;break;case 2:b=x,I=d,k=se;break;case 3:b=x,I=ee,k=d;break;case 4:b=se,I=x,k=d;break;case 5:b=d,I=x,k=ee;break}var de=[Math.floor(b*255),Math.floor(I*255),Math.floor(k*255)];return de}function f(r){r=r.replace(/^#/,""),r=r.length===3?r.replace(/(.)/g,"$1$1"):r;var l=parseInt(r.substr(0,2),16)/255,c=parseInt(r.substr(2,2),16)/255,d=parseInt(r.substr(4,2),16)/255,h=Math.max(l,c,d),w=h-Math.min(l,c,d),x=h?w/h:0;switch(h){case l:return[60*((c-d)/w%6)||0,x,h];case c:return[60*((d-l)/w+2)||0,x,h];case d:return[60*((l-c)/w+4)||0,x,h]}}function M(r){var l=r[0],c=r[1]/100,d=r[2]/100,h=(2-c)*d;return[l,Math.round(c*d/(h<1?h:2-h)*1e4)/100,h/2*100]}function N(r){for(var l=0,c=0;c!==r.length&&!(l>=Number.MAX_SAFE_INTEGER);c++)l+=r.charCodeAt(c);return l}function E(r){if(isNaN(r)){if(typeof r=="string"){if(o[r]){var c=o[r];if(c.hueRange)return c.hueRange}else if(r.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){var d=f(r)[0];return j(d).hueRange}}}else{var l=parseInt(r);if(l<360&&l>0)return j(r).hueRange}return[0,360]}return g})}(Pe,Pe.exports)),Pe.exports}var wr=br(),Sr=Ht(wr);function xr(n,i){let a="bright",o;return/water|ocean|lake|sea|river/.test(n)&&(o="blue"),/state|country|place/.test(n)&&(o="pink"),/road|highway|transport|streets/.test(n)&&(o="orange"),/contour|building|earth/.test(n)&&(o="monochrome"),/building/.test(n)&&(a="dark"),/earth/.test(n)&&(a="light"),/contour|landuse/.test(n)&&(o="yellow"),/wood|forest|park|landcover|land|natural/.test(n)&&(o="green"),`rgba(${Sr({luminosity:a,hue:o,seed:n,format:"rgbArray"}).join(", ")}, ${i||"1"})`}var $r={brightColor:xr};function Cr(n){return n.metadata&&n.metadata["maplibregl-inspect:inspect"]}function Tr(n){return Object.assign(n,{metadata:Object.assign({},n.metadata,{"maplibregl-inspect:inspect":!0})})}class ct{constructor(i){if(this._onSourceChange=o=>At(this,void 0,void 0,function*(){if(o.sourceDataType==="visibility"||!o.isSourceLoaded)return;const u=Object.assign({},this.sources);yield this._setSourcesFromMap(),!ur(u,this.sources)&&Object.keys(this.sources).length>0&&setTimeout(()=>this.render(),1e3)}),this._onStyleChange=()=>{const o=this._map.getStyle();Cr(o)||(this._originalStyle=o)},this._onRightClick=()=>{!this.options.showMapPopupOnHover&&!this.options.showInspectMapPopupOnHover&&!this.options.blockHoverPopupOnClick&&this._popup&&this._popup.remove()},this._onMousemove=o=>{if(this._showInspectMap){if(!this.options.showInspectMapPopup||o.type==="mousemove"&&!this.options.showInspectMapPopupOnHover)return;o.type==="click"&&this.options.showInspectMapPopupOnHover&&this.options.blockHoverPopupOnClick&&(this._popupBlocked=!this._popupBlocked)}else{if(!this.options.showMapPopup||o.type==="mousemove"&&!this.options.showMapPopupOnHover)return;o.type==="click"&&this.options.showMapPopupOnHover&&this.options.blockHoverPopupOnClick&&(this._popupBlocked=!this._popupBlocked)}if(!this._popupBlocked&&this._popup){let u;this.options.selectThreshold===0?u=o.point:u=[[o.point.x-this.options.selectThreshold,o.point.y+this.options.selectThreshold],[o.point.x+this.options.selectThreshold,o.point.y-this.options.selectThreshold]];const g=this._map.queryRenderedFeatures(u,this.options.queryParameters)||[];if(this._map.getCanvas().style.cursor=g.length?"pointer":"",!g.length)this._popup.remove();else{this._popup.setLngLat(o.lngLat);const v=this.options.renderPopup(g);typeof v=="string"?this._popup.setHTML(v):this._popup.setDOMContent(v),this._popup.addTo(this._map)}}},!(this instanceof ct))throw new Error("MaplibreInspect needs to be called with the new keyword");let a=null;window.maplibregl?a=new window.maplibregl.Popup({closeButton:!1,closeOnClick:!1}):i.popup||console.error("Maplibre GL JS can not be found. Make sure to include it or pass an initialized MaplibreGL Popup to MaplibreInspect if you are using moduleis."),this.options=Object.assign({showInspectMap:!1,showInspectButton:!0,showInspectMapPopup:!0,showMapPopup:!1,showMapPopupOnHover:!0,showInspectMapPopupOnHover:!0,blockHoverPopupOnClick:!1,backgroundColor:"#fff",assignLayerColor:$r.brightColor,buildInspectStyle:Et.generateInspectStyle,renderPopup:yr,popup:a,selectThreshold:5,useInspectStyle:!0,queryParameters:{},sources:{},toggleCallback(){},manageStyleOutside:!1},i),this.sources=this.options.sources,this.assignLayerColor=this.options.assignLayerColor,this._popup=this.options.popup,this._popupBlocked=!1,this._showInspectMap=this.options.showInspectMap,this._toggle=new dr({show:this.options.showInspectButton,onToggle:()=>this.toggleInspector()})}toggleInspector(){this._showInspectMap=!this._showInspectMap,this._popupBlocked=!1,this.options.toggleCallback(this._showInspectMap),this.render()}_inspectStyle(){const i=Et.generateColoredLayers(this.sources,this.assignLayerColor);return this.options.buildInspectStyle(this._map.getStyle(),i,{backgroundColor:this.options.backgroundColor})}render(){this._showInspectMap?(this.options.useInspectStyle&&this._map.setStyle(Tr(this._inspectStyle())),this._toggle.setMapIcon()):this._originalStyle&&(this._popup&&this._popup.remove(),this.options.useInspectStyle&&this._map.setStyle(this._originalStyle),this._toggle.setInspectIcon())}_setSourcesFromMap(){return At(this,void 0,void 0,function*(){var i;const a=this._map.getStyle(),o=Object.keys(a.sources);for(const u of o)if(a.sources[u].type==="geojson")this.sources[u]=[];else if(a.sources[u].type==="vector"&&a.sources[u].url)try{const v=yield(yield fetch(a.sources[u].url)).json(),_=(i=v?.vector_layers)===null||i===void 0?void 0:i.map(T=>T.id);if(_)this.sources[u]=_;else throw new Error("Missing vector_layers in source: "+u)}catch{console.warn("Unable to retrieve tileJSON from "+a.sources[u].url+" using style's layers");for(const v of a.layers)if("source-layer"in v&&v["source-layer"]){const _=v["source-layer"];this.sources[u]||(this.sources[u]=[]),this.sources[u].push(_)}}for(const u of Object.keys(this.sources))o.indexOf(u)===-1?delete this.sources[u]:this.sources[u]=[...new Set(this.sources[u])]})}setOriginalStyle(i){this._originalStyle=i,this._setSourcesFromMap()}onAdd(i){return this._map=i,Object.keys(this.sources).length===0&&(i.on("tiledata",this._onSourceChange),i.on("sourcedata",this._onSourceChange)),i.on("styledata",this._onStyleChange),i.on("load",this._onStyleChange),i.on("mousemove",this._onMousemove),i.on("click",this._onMousemove),i.on("contextmenu",this._onRightClick),this._toggle.elem}onRemove(){this._map.off("styledata",this._onStyleChange),this._map.off("load",this._onStyleChange),this._map.off("tiledata",this._onSourceChange),this._map.off("sourcedata",this._onSourceChange),this._map.off("mousemove",this._onMousemove),this._map.off("click",this._onMousemove),this._map.off("contextmenu",this._onRightClick);const i=this._toggle.elem;i.parentNode.removeChild(i),this._map=void 0}}var Mr=B('<a class="underline text-purple"target=_blank rel=noreferrer> '),Or=B("<div class=features-properties>"),Ir=B("<div><span><strong></strong><span> (<!>)</span></span><table><tbody><tr><td>id</td><td>"),Ar=B("<tr><td></td><td>"),Pr=B('<div class="w-1/2 h-full w-full p-2 flex flex-col"><button type=button class=btn-primary>Copy to clipboard</button><textarea readonly class="text-xs font-mono p-2 border mt-4 w-full overflow-x-scroll overflow-y-scroll flex-1">'),Lr=B("<div class=hidden>"),Er=B('<div class="h-full w-full flex">'),kr=B('<div class="font-bold text-red"><a class=underline href=https://docs.protomaps.com/basemaps/downloads#current-version>See Docs.'),Br=B('<div class="absolute bottom-0 p-1 text-xs bg-white bg-opacity-50"> z@<div class="hidden lg:block font-bold">Drag .pmtiles here to view'),jr=B('<div class="absolute p-8 flex justify-center items-center bg-white bg-opacity-50 font-mono text-red">'),Rr=B('<div class="flex-1 font-mono">Dropped file '),Nr=B('<button class="btn-primary bg-gray text-black"type=button>close'),Hr=B('<input class="border-2 border-gray p-1 flex-1 text-xs lg:text-base"type=text name=tiles autocomplete=off>'),Dr=B("<button class=btn-primary type=submit>load"),Fr=B('<select><option value="">main'),zr=B('<div class="flex flex-col h-dvh w-full"><div class="max-w-[1500px] mx-auto"><form class="flex space-x-2"><button class=btn-primary type=submit>fit bounds</button></form><div class="flex my-2 space-y-2 lg:space-y-0 space-x-2 flex-col lg:flex-row items-center"><div class="flex items-center"><label for=flavorName class="text-xs mr-1">flavor</label><select id=flavorName autocomplete=on><option value=light>light</option><option value=dark>dark</option><option value=white>data viz (white)</option><option value=grayscale>data viz (grayscale)</option><option value=black>data viz (black)</option></select></div><div class="flex items-center"><label for=lang class="text-xs mr-1">language</label><select id=lang autocomplete=on></select></div><div class="hidden lg:inline"><input id=localSprites type=checkbox><label for=localSprites class="text-xs ml-1">local sprites</label></div><div class="hidden lg:inline"><input id=showBoxes type=checkbox><label for=showBoxes class="text-xs ml-1">bboxes</label></div><button type=button class="btn-primary hidden lg:inline"></button></div></div><div class="h-full flex grow-1">'),Gr=B("<option> (<!>)"),Vr=B("<button class=btn-primary type=button>style version"),qr=B("<option>");const Ur=5,Bt="https://demo-bucket.protomaps.com/v4.pmtiles",Jr='<a href="https://github.com/protomaps/basemaps">Protomaps</a> Â© <a href="https://openstreetmap.org">OpenStreetMap</a>';function Kr(n){return"source-layer"in n&&n["source-layer"]?n["source-layer"]:""}const Wr=n=>Number(BigInt(n)&(BigInt(1)<<BigInt(44))-BigInt(1)),Zr=n=>{const i=BigInt(n)>>BigInt(44)&BigInt(3);return i===BigInt(1)?"node":i===BigInt(2)?"way":i===BigInt(3)?"relation":"not_osm"},Yr=n=>{if(n){const i=Zr(n);if(i!=="not_osm"){const a=Wr(n);return(()=>{var o=Mr(),u=o.firstChild;return rr(o,"href",`https://openstreetmap.org/${i}/${a}`),$(o,i,u),$(o,a,null),o})()}}return n},Xr=n=>(()=>{var i=Or();return $(i,J(Ke,{get each(){return n.features},children:a=>(()=>{var o=Ir(),u=o.firstChild,g=u.firstChild,v=g.nextSibling,_=v.firstChild,T=_.nextSibling;T.nextSibling;var V=u.nextSibling,L=V.firstChild,F=L.firstChild,Q=F.firstChild,j=Q.nextSibling;return $(g,()=>Kr(a.layer)),$(v,()=>a.geometry.type,T),$(j,()=>Yr(a.id)),$(L,J(Ke,{get each(){return Object.entries(a.properties)},children:([q,U])=>(()=>{var R=Ar(),re=R.firstChild,m=re.nextSibling;return $(re,q),$(m,U),R})()}),null),o})()})),i})();function at(n,i,a,o,u,g,v){const _={version:8,sources:{},layers:[]};if(!u||!o)return _;let T;return v?T=`pmtiles://${v.source.getKey()}`:nr(u)?T=`pmtiles://${u}`:T=u,_.layers=[],i?_.sprite=`${location.protocol}//${location.host}/${a}`:_.sprite=`https://protomaps.github.io/basemaps-assets/sprites/v4/${a}`,_.glyphs="https://protomaps.github.io/basemaps-assets/fonts/{fontstack}/{range}.pbf",_.sources={protomaps:{type:"vector",attribution:Jr,url:T}},g&&g.length>0?_.layers=_.layers.concat(g):_.layers=_.layers.concat(or("protomaps",o,{lang:n})),_}function Qr(n){const i=lt(()=>JSON.stringify(at(n.lang,!1,n.flavorName,n.flavor,n.tiles),null,4));return(()=>{var a=Pr(),o=a.firstChild,u=o.nextSibling;return o.$$click=()=>{navigator.clipboard.writeText(i())},$(u,i),a})()}function es(n){let i,a,o,u;const[g,v]=G(),[_,T]=G(),[V,L]=G(),[F,Q]=G(0),[j,q]=G("");er(()=>{if(n.ref?.({fit:R}),ne.getRTLTextPluginStatus()==="unavailable"&&ne.setRTLTextPlugin("https://unpkg.com/@mapbox/mapbox-gl-rtl-text@0.2.3/mapbox-gl-rtl-text.min.js",!0),!i){console.error("Could not mount map element");return}const m=new ar({metadata:!0});L(m),ne.addProtocol("pmtiles",m.tile);const f=new ne.Map({hash:"map",container:i,style:at("en",!1,n.flavorName,n.flavor),attributionControl:!1});f.addControl(new ne.NavigationControl),f.addControl(new ne.GlobeControl),f.addControl(new ne.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,fitBoundsOptions:{animate:!1}})),f.addControl(new ne.AttributionControl({compact:!1})),f.addControl(new ct({popup:new ne.Popup({closeButton:!1,closeOnClick:!1})}));const M=new ne.Popup({closeButton:!0,closeOnClick:!1,maxWidth:"none"});f.on("load",()=>{f.resize()}),f.on("error",r=>{v(r.error.message)}),f.on("idle",()=>{Q(f.getZoom()),v(void 0),U().then(r=>{if(r?.metadata){const l=r.metadata;T(`tiles@${l.version} ${l["planetiler:osm:osmosisreplicationtime"]?.substr(0,10)}`)}})});const N=r=>{const l=f.queryRenderedFeatures(r.point);o&&l.length?(o.innerHTML="",Rt(()=>J(Xr,{features:l}),o),M.setHTML(o.innerHTML),M.setLngLat(r.lngLat),M.addTo(f)):M.remove()};f.on("contextmenu",r=>{N(r)}),f.on("touchstart",r=>{u=setTimeout(()=>{N(r)},500)});const E=()=>{clearTimeout(u)};return f.on("zoom",r=>{Q(r.target.getZoom())}),f.on("touchend",E),f.on("touchcancel",E),f.on("touchmove",E),f.on("pointerdrag",E),f.on("pointermove",E),f.on("moveend",E),f.on("gesturestart",E),f.on("gesturechange",E),f.on("gestureend",E),a=f,()=>{L(void 0),ne.removeProtocol("pmtiles"),f.remove()}});const U=async()=>{if(!n.droppedArchive&&n.tiles?.endsWith(".json")){const M=await(await fetch(n.tiles)).json();return{metadata:M,bounds:[[M.bounds[0],M.bounds[1]],[M.bounds[2],M.bounds[3]]]}}const m=V();if(m){let f=n.droppedArchive;if(f?m.add(f):n.tiles&&(f=m.tiles.get(n.tiles),f||(f=new Nt(n.tiles),m.add(f))),f){const M=await f.getMetadata(),N=await f.getHeader();return{metadata:M,bounds:[[N.minLon,N.minLat],[N.maxLon,N.maxLat]]}}}},R=async()=>{const m=(await U())?.bounds;m&&a?.fitBounds(m,{animate:!1})},re=lt(()=>at(n.lang,n.localSprites,n.flavorName,n.flavor,n.tiles,n.npmLayers,n.droppedArchive));return Le(()=>{const m=n.npmVersion?+n.npmVersion.split(".")[0]:Ur;U().then(f=>{if(f&&f.metadata instanceof Object&&"version"in f.metadata){const M=+f.metadata.version.split(".")[0];tr[M].indexOf(m)<0?q(`style v${m} may not be compatible with tileset v${M}. `):q("")}})}),Le(()=>{a&&(a.showTileBoundaries=n.showBoxes,a.showCollisionBoxes=n.showBoxes)}),Le(()=>{a&&a.setStyle(re())}),[(()=>{var m=Lr(),f=o;return typeof f=="function"?Ot(f,m):o=m,m})(),(()=>{var m=Er(),f=i;return typeof f=="function"?Ot(f,m):i=m,m})(),(()=>{var m=Br(),f=m.firstChild,M=f.nextSibling;return $(m,_,f),$(m,()=>F().toFixed(2),M),$(m,J(xe,{get when(){return j()},get children(){var N=kr(),E=N.firstChild;return $(N,j,E),N}}),null),m})(),J(xe,{get when(){return g()},get children(){var m=jr();return $(m,g),m}})]}function ts(){const n=Zn(location.hash),[i,a]=G(n.flavorName||"light"),[o,u]=G(n.lang||"en"),[g,v]=G(n.tiles||Bt),[_,T]=G(n.local_sprites==="true"),[V,L]=G(n.show_boxes==="true"),[F,Q]=G(!1),[j,q]=G(n.npm_version),[U,R]=G([]),[re,m]=G([]),[f,M]=G(),[N,E]=G();Le(()=>{const b={flavorName:i(),lang:o(),tiles:f()||g()===Bt?void 0:g(),local_sprites:_()?"true":void 0,show_boxes:V()?"true":void 0,npm_version:j()?j():void 0};location.hash=Yn(location.hash,b)});const r=()=>ir(i()),l=b=>{b.preventDefault(),b.dataTransfer&&M(new Nt(new sr(b.dataTransfer.files[0])))},c=b=>(b.preventDefault(),!1),d=b=>{const I=b.charCode;I>=49&&I<=53&&a(["light","dark","white","grayscale","black"][I-49])},h=b=>{b.preventDefault();const k=new FormData(b.target).get("tiles");typeof k=="string"&&v(k)},w=async b=>{const I=await fetch(`https://registry.npmjs.org/${b}`,{headers:{Accept:"application/vnd.npm.install-v1+json"}});return Object.keys((await I.json()).versions)},x=async()=>{const b=await w("protomaps-themes-base"),I=await w("@protomaps/basemaps");R([...b,...I].sort().filter(k=>+k.split(".")[0]>=2).reverse())};Le(()=>{(async()=>{const b=j();m(b===void 0||b===""?[]:await Xn(b,i()))})()}),It.sort((b,I)=>b.full_name.localeCompare(I.full_name));const ee=()=>{N()?.fit()},se=()=>{M(void 0)};return(()=>{var b=zr(),I=b.firstChild,k=I.firstChild,de=k.firstChild,Ee=k.nextSibling,ke=Ee.firstChild,We=ke.firstChild,Be=We.nextSibling,je=ke.nextSibling,C=je.firstChild,be=C.nextSibling,Re=je.nextSibling,Z=Re.firstChild,$e=Re.nextSibling,Ce=$e.firstChild,we=$e.nextSibling,oe=I.nextSibling;return $(b,J(Qn,{page:0}),I),k.addEventListener("submit",h),$(k,J(xe,{get when(){return f()},get children(){return[(()=>{var S=Rr();return S.firstChild,$(S,()=>f()?.source.getKey(),null),S})(),(()=>{var S=Nr();return S.$$click=se,S})()]}}),de),$(k,J(xe,{get when(){return!f()},get children(){return[(()=>{var S=Hr();return ve(()=>S.value=g()),S})(),Dr()]}}),de),de.$$click=ee,Be.addEventListener("change",S=>a(S.target.value)),be.addEventListener("change",S=>u(S.target.value)),$(be,J(Ke,{each:It,children:S=>(()=>{var K=Gr(),ce=K.firstChild,Ne=ce.nextSibling;return Ne.nextSibling,$(K,()=>S.lang,ce),$(K,()=>S.full_name,Ne),ve(()=>K.value=S.lang),K})()})),Z.addEventListener("change",S=>T(S.currentTarget.checked)),Ce.addEventListener("change",S=>L(S.currentTarget.checked)),$(Ee,J(xe,{get when(){return U().length>0},get fallback(){return(()=>{var S=Vr();return S.$$click=x,S})()},get children(){var S=Fr();return S.firstChild,S.addEventListener("change",K=>q(K.target.value)),$(S,J(Ke,{get each(){return U()},children:K=>(()=>{var ce=qr();return ce.value=K,$(ce,K),ce})()}),null),ve(()=>S.value=j()),S}}),we),we.$$click=()=>Q(!F()),$(we,()=>F()?"Close style JSON":"Get style JSON"),oe.addEventListener("drop",l),oe.addEventListener("dragover",c),oe.addEventListener("keypress",d),$(oe,J(es,{ref:E,get tiles(){return g()},get localSprites(){return _()},get showBoxes(){return V()},get flavorName(){return i()},get flavor(){return r()},get lang(){return o()},get npmLayers(){return re()},get npmVersion(){return j()},get droppedArchive(){return f()}}),null),$(oe,J(xe,{get when(){return F()},get children(){return J(Qr,{get flavorName(){return i()},get flavor(){return r()},get lang(){return o()},get tiles(){return lt(()=>!!f())()?"example.pmtiles":g()}})}}),null),ve(()=>Be.value=i()),ve(()=>be.value=o()),ve(()=>Z.checked=_()),ve(()=>Ce.checked=V()),b})()}const jt=document.getElementById("root");jt&&Rt(()=>J(ts,{}),jt);Wn(["click"]);
