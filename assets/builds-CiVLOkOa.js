import{r as K,c as f,d as P,j as T,a as E,i,N as H,g as Y,F as q,t as b,s as u,f as y,V as G,S as D}from"./utils-cxvEfPFo.js";var J=b("<span>md5:"),U=b("<span> b3:"),Z=b("<span>"),Q=b('<tr><td><input type=radio><input class=ml-2 type=radio></td><td></td><td></td><td></td><td class="hidden lg:table-cell"></td><td class="hidden lg:table-cell"></td><td><a class=underline>map</a></td><td><a class=underline>xray</a></td><td class="hidden lg:table-cell"><a class=underline>download</a></td><td class="hidden lg:table-cell">'),W=b("<a class=underline>stats"),X=b('<div class="flex flex-col h-screen w-full"><div class="max-w-[1500px] mx-auto"><h1 class="my-8 text-4xl">Builds</h1><p>See the <a class=underline href=https://docs.protomaps.com/basemaps/downloads target=_blank rel=noreferrer>Documentation</a> for how to use.</p><div class="space-x-2 my-2"><button class=btn-primary type=button>Compare selected versions</button></div><table class="table-auto border-separate text-xs lg:text-base border-spacing-2 lg:border-spacing-4 font-mono"><thead class=text-sm><tr><th></th><th>date</th><th>compatible <a class=underline href=https://www.npmjs.com/package/@protomaps/basemaps target=_blank rel=noreferrer>npm versions</a></th><th>tileset version</th><th>size</th><th>hashes</th><th></th><th></th><th></th></tr></thead><tbody>'),tt=b("<button class=btn-primary type=button>Compare in Maperture");function F(t){if(!t)return"";const e=atob(t);let s="";for(let o=0;o<e.length;o++){const d=e.charCodeAt(o).toString(16).padStart(2,"0");s+=d}return s}function et(t){const e=Number.parseInt(t.substring(0,4),10),s=Number.parseInt(t.substring(4,6),10)-1,o=Number.parseInt(t.substring(6,8),10);return new Date(e,s,o)}function st(t,e=2){if(!+t)return"0 Bytes";const s=1024,o=e<0?0:e,d=["Bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],g=Math.floor(Math.log(t)/Math.log(s));return`${Number.parseFloat((t/s**g).toFixed(o))} ${d[g]}`}function nt(t){return(()=>{var e=Z();return i(e,f(D,{get when(){return t.md5sum},get children(){var s=J();return s.firstChild,i(s,()=>F(t.md5sum).substr(0,8),null),y(()=>u(s,"title",F(t.md5sum))),s}}),null),i(e,f(D,{get when(){return t.b3sum},get children(){var s=U();return s.firstChild,i(s,()=>t.b3sum?.substr(0,8),null),y(()=>u(s,"title",t.b3sum)),s}}),null),e})()}function rt(t){const e=t.build,s=e.key.substr(0,8),o=et(s),d=`https://build.protomaps.com/${e.key}`,g=`https://build.protomaps.com/${s}.layerstats.parquet`,p=t.idx,C=()=>{t.setCmpA(p)},S=()=>{t.setCmpB(p)},c=n=>{try{return G[+n.split(".")[0]].join(",")}catch{return""}};return(()=>{var n=Q(),a=n.firstChild,r=a.firstChild,m=r.nextSibling,v=a.nextSibling,x=v.nextSibling,_=x.nextSibling,B=_.nextSibling,$=B.nextSibling,h=$.nextSibling,O=h.firstChild,k=h.nextSibling,R=k.firstChild,w=k.nextSibling,V=w.firstChild,z=w.nextSibling;return r.addEventListener("change",C),m.addEventListener("change",S),i(v,()=>e.key),i(x,()=>c(e.version)),i(_,()=>e.version),i(B,()=>st(e.size)),i($,()=>nt(e)),u(O,"href",`/#tiles=${d}`),u(R,"href",`https://protomaps.github.io/PMTiles/?url=${d}`),u(V,"href",d),i(z,s>="20231228"?(()=>{var l=W();return u(l,"href",g),l})():null),y(l=>{var j=p<=t.cmpB,A=`compare earlier build ${o.toDateString()}`,I=p>=t.cmpA,M=`compare later build ${o.toDateString()}`,N=e.uploaded;return j!==l.e&&(r.disabled=l.e=j),A!==l.t&&u(r,"aria-label",l.t=A),I!==l.a&&(m.disabled=l.a=I),M!==l.o&&u(m,"aria-label",l.o=M),N!==l.i&&u(v,"title",l.i=N),l},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),y(()=>r.checked=p===t.cmpA),y(()=>m.checked=p===t.cmpB),n})()}function lt(){const[t]=T(async()=>(await(await fetch("https://build-metadata.protomaps.dev/builds.json")).json()).sort((a,r)=>a.key<r.key?1:a.key>r.key?-1:0)),[e]=T(async()=>{const n=await(await fetch("https://registry.npmjs.org/@protomaps/basemaps",{headers:{Accept:"application/vnd.npm.install-v1+json"}})).json(),a=Object.keys(n.versions).filter(r=>+r.split(".")[0]>=2);return a[a.length-1]}),[s,o]=E(1),[d,g]=E(0),p="light",C=()=>{const c=`https://build.protomaps.com/${t()[s()].key}`,n=`https://build.protomaps.com/${t()[d()].key}`;open(`/visualtests/?leftTiles=${c}&rightTiles=${n}`)},S=()=>{const c=t()[s()].key.replace(".pmtiles",""),n=t()[d()].key.replace(".pmtiles",""),a={name:`${c} ${e()} ${p}`,type:"maplibre-gl",renderer:"maplibre-gl",index:0,url:`https://npm-style.protomaps.dev/style.json?version=${e()}&theme=${p}&tiles=${c}`},r={name:`${n} ${e()} ${p}`,type:"maplibre-gl",renderer:"maplibre-gl",index:0,url:`https://npm-style.protomaps.dev/style.json?version=${e()}&theme=${p}&tiles=${n}`},m=JSON.stringify([a,r]);open(`https://stamen.github.io/maperture/#maps=${encodeURIComponent(m)}`)};return(()=>{var c=X(),n=c.firstChild,a=n.firstChild,r=a.nextSibling,m=r.nextSibling,v=m.firstChild,x=m.nextSibling,_=x.firstChild,B=_.nextSibling;return i(c,f(H,{page:1}),n),v.$$click=C,i(m,(()=>{var $=Y(()=>!!e());return()=>$()?(()=>{var h=tt();return h.$$click=S,h})():null})(),null),i(B,f(q,{get each(){return t()},children:($,h)=>f(rt,{build:$,get idx(){return h()},get cmpA(){return s()},get cmpB(){return d()},setCmpA:o,setCmpB:g})})),c})()}const L=document.getElementById("root");L&&K(()=>f(lt,{}),L);P(["click"]);
