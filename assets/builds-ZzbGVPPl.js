import{r as K,c as f,d as H,j as E,a as D,t as b,i as o,N as Y,g as q,F as G,s as u,f as v,V as J,S as P}from"./utils-DDxLlqhC.js";var U=b("<span>md5:"),Z=b("<span> b3:"),Q=b("<span>"),W=b('<tr><td><input type=radio><input class=ml-2 type=radio></td><td></td><td></td><td></td><td class="hidden lg:table-cell"></td><td class="hidden lg:table-cell"></td><td><a class=underline>map</a></td><td><a class=underline>xray</a></td><td class="hidden lg:table-cell"><a class=underline>download</a></td><td class="hidden lg:table-cell">'),X=b("<a class=underline>stats"),tt=b('<div class="flex flex-col h-screen w-full"><div class="max-w-[1500px] mx-auto"><h1 class="my-8 text-4xl">Builds</h1><p>See the <a class=underline href=https://docs.protomaps.com/basemaps/downloads target=_blank rel=noreferrer>Documentation</a> for how to use.</p><div class="space-x-2 my-2"><button class=btn-primary type=button>Compare selected versions</button></div><table class="table-auto border-separate text-xs lg:text-base border-spacing-2 lg:border-spacing-4 font-mono"><thead class=text-sm><tr><th></th><th>date</th><th>compatible <a class=underline href=https://www.npmjs.com/package/@protomaps/basemaps target=_blank rel=noreferrer>npm versions</a></th><th>tileset version</th><th>size</th><th>hashes</th><th></th><th></th><th></th></tr></thead><tbody>'),et=b("<button class=btn-primary type=button>Compare in Maperture");function F(t){if(!t)return"";const e=atob(t);let s="";for(let r=0;r<e.length;r++){const d=e.charCodeAt(r).toString(16).padStart(2,"0");s+=d}return s}function st(t){const e=Number.parseInt(t.substring(0,4),10),s=Number.parseInt(t.substring(4,6),10)-1,r=Number.parseInt(t.substring(6,8),10);return new Date(e,s,r)}function nt(t,e=2){if(!+t)return"0 Bytes";const s=1024,r=e<0?0:e,d=["Bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],g=Math.floor(Math.log(t)/Math.log(s));return`${Number.parseFloat((t/s**g).toFixed(r))} ${d[g]}`}function rt(t){return(()=>{var e=Q();return o(e,f(P,{get when(){return t.md5sum},get children(){var s=U();return s.firstChild,o(s,()=>F(t.md5sum).substr(0,8),null),v(()=>u(s,"title",F(t.md5sum))),s}}),null),o(e,f(P,{get when(){return t.b3sum},get children(){var s=Z();return s.firstChild,o(s,()=>{var r;return(r=t.b3sum)==null?void 0:r.substr(0,8)},null),v(()=>u(s,"title",t.b3sum)),s}}),null),e})()}function lt(t){const e=t.build,s=e.key.substr(0,8),r=st(s),d=`https://build.protomaps.com/${e.key}`,g=`https://build.protomaps.com/${s}.layerstats.parquet`,p=t.idx,B=()=>{t.setCmpA(p)},C=()=>{t.setCmpB(p)},c=n=>{try{return J[+n.split(".")[0]].join(",")}catch{return""}};return(()=>{var n=W(),i=n.firstChild,a=i.firstChild,m=a.nextSibling,y=i.nextSibling,x=y.nextSibling,_=x.nextSibling,k=_.nextSibling,$=k.nextSibling,h=$.nextSibling,O=h.firstChild,w=h.nextSibling,R=w.firstChild,j=w.nextSibling,V=j.firstChild,z=j.nextSibling;return a.addEventListener("change",B),m.addEventListener("change",C),o(y,()=>e.key),o(x,()=>c(e.version)),o(_,()=>e.version),o(k,()=>nt(e.size)),o($,()=>rt(e)),u(O,"href",`/#tiles=${d}`),u(R,"href",`https://protomaps.github.io/PMTiles/?url=${d}`),u(V,"href",d),o(z,s>="20231228"?(()=>{var l=X();return u(l,"href",g),l})():null),v(l=>{var S=r.getDay()===1?"black":"#aaa",A=p<=t.cmpB,I=`compare earlier build ${r.toDateString()}`,M=p>=t.cmpA,N=`compare later build ${r.toDateString()}`,T=e.uploaded;return S!==l.e&&((l.e=S)!=null?n.style.setProperty("color",S):n.style.removeProperty("color")),A!==l.t&&(a.disabled=l.t=A),I!==l.a&&u(a,"aria-label",l.a=I),M!==l.o&&(m.disabled=l.o=M),N!==l.i&&u(m,"aria-label",l.i=N),T!==l.n&&u(y,"title",l.n=T),l},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),v(()=>a.checked=p===t.cmpA),v(()=>m.checked=p===t.cmpB),n})()}function at(){const[t]=E(async()=>(await(await fetch("https://build-metadata.protomaps.dev/builds.json")).json()).sort((i,a)=>i.key<a.key?1:i.key>a.key?-1:0)),[e]=E(async()=>{const n=await(await fetch("https://registry.npmjs.org/@protomaps/basemaps",{headers:{Accept:"application/vnd.npm.install-v1+json"}})).json(),i=Object.keys(n.versions).filter(a=>+a.split(".")[0]>=2);return i[i.length-1]}),[s,r]=D(1),[d,g]=D(0),p="light",B=()=>{const c=`https://build.protomaps.com/${t()[s()].key}`,n=`https://build.protomaps.com/${t()[d()].key}`;open(`/visualtests/?leftTiles=${c}&rightTiles=${n}`)},C=()=>{const c=t()[s()].key.replace(".pmtiles",""),n=t()[d()].key.replace(".pmtiles",""),i={name:`${c} ${e()} ${p}`,type:"maplibre-gl",renderer:"maplibre-gl",index:0,url:`https://npm-style.protomaps.dev/style.json?version=${e()}&theme=${p}&tiles=${c}`},a={name:`${n} ${e()} ${p}`,type:"maplibre-gl",renderer:"maplibre-gl",index:0,url:`https://npm-style.protomaps.dev/style.json?version=${e()}&theme=${p}&tiles=${n}`},m=JSON.stringify([i,a]);open(`https://stamen.github.io/maperture/#maps=${encodeURIComponent(m)}`)};return(()=>{var c=tt(),n=c.firstChild,i=n.firstChild,a=i.nextSibling,m=a.nextSibling,y=m.firstChild,x=m.nextSibling,_=x.firstChild,k=_.nextSibling;return o(c,f(Y,{page:1}),n),y.$$click=B,o(m,(()=>{var $=q(()=>!!e());return()=>$()?(()=>{var h=et();return h.$$click=C,h})():null})(),null),o(k,f(G,{get each(){return t()},children:($,h)=>f(lt,{build:$,get idx(){return h()},get cmpA(){return s()},get cmpB(){return d()},setCmpA:r,setCmpB:g})})),c})()}const L=document.getElementById("root");L&&K(()=>f(at,{}),L);H(["click"]);
